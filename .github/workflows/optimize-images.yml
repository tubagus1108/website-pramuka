name: Optimize Images (Manual)

on:
  workflow_dispatch: # Manual trigger only

jobs:
  optimize:
    name: Optimize Images on Server
    runs-on: ubuntu-latest
    
    steps:
      - name: ğŸ–¼ï¸ Run Image Optimization
        uses: appleboy/ssh-action@v1.0.0
        with:
          host: ${{ secrets.SERVER_HOST }}
          username: ${{ secrets.SERVER_USER }}
          password: ${{ secrets.SERVER_PASSWORD }}
          port: 22
          script: |
            echo "ğŸ–¼ï¸ Starting image optimization..."
            
            # Navigate to project directory
            cd /var/www/website-pramuka || exit 1
            
            # Run image optimization
            echo "ğŸ“Š Optimizing images (resize + compress)..."
            php artisan images:optimize
            
            echo "âœ… Image optimization completed!"
            
      - name: ğŸ‰ Optimization Success
        if: success()
        run: |
          echo "âœ… Images optimized successfully!"
          echo "ğŸ“Š Check server logs for details"
